version: '3'
services:
  pi:
    image: misalcedo/picam
    env_file: users.env
    build:
      context: .
      args:
        domain: puppy-cam.salcedo.cc
        camera: pi
        port: 443
        opencv_version: 4.0.1
    ports:
      - 1629:443
    devices:
      - /dev/vchiq
    volumes:
      - /etc/letsencrypt/live/puppy-cam.salcedo.cc/fullchain.pem:/usr/src/app/fullchain.pem
      - /etc/letsencrypt/live/puppy-cam.salcedo.cc/privkey.pem:/usr/src/app/privkey.pem
      - .:/usr/src/app
  usb:
    image: misalcedo/picam
    env_file: users.env
    build:
      context: .
      args:
        domain: Fayt
        camera: usb
        port: 443
        opencv_version: 4.0.1
    ports:
      - 1629:443
    devices:
      - /dev/video0
    volumes:
      - .:/usr/src/app
